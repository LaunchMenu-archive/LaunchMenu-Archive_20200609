{"version":3,"sources":["../../../src/core/registry/module.js"],"names":["Module","constructor","request","canBeDirectlyInstantiated","ready","resolve","reject","requestPath","RequestPath","origin","augmentPath","getClsas","modulePath","Registry","_deregisterModuleInstance","then","ID","Channel","createSender","type","toString","channel","error","Error","getClass","__proto__","getPath","__ready"],"mappings":";;;;;;;;;;;;AAAA;;;;;;AACe,MAAMA,MAAN,CAAY;AACvBC,gBAAYC,OAAZ,EAAqBC,yBAArB,EAA+C;AAC3C,aAAKC,KAAL,GAAa,sBAAY,CAACC,OAAD,EAAUC,MAAV,KAAmB;AACxC,gBAAGJ,OAAH,EAAW;AACP,sBAAMK,cAAc,IAAIC,WAAJ,CAAgBN,QAAQO,MAAxB,CAApB;AACA,qBAAKF,WAAL,GAAmBA,YAAYG,WAAZ,CAAwB,KAAKC,QAAL,GAAgBC,UAAxC,EAAoD,CAApD,CAAnB;AACAC,yBAASC,yBAAT,CAAmC,IAAnC,EAAyCC,IAAzC,CAA8CC,MAAI;AAC9CC,sCAAQC,YAAR,CACIhB,QAAQO,MADZ,EAEIP,QAAQiB,IAFZ,EAGI,KAAKZ,WAAL,CAAiBa,QAAjB,CAA0B,IAA1B,CAHJ,EAIEL,IAJF,CAIOM,WAAS;AACZ,6BAAKZ,MAAL,GAAcY,OAAd;AACAhB,gCAAQ,IAAR;AACH,qBAPD;AAQH,iBATD;AAUH,aAbD,MAaM,IAAG,CAACF,yBAAJ,EAA8B;AAChC,sBAAMmB,QAAQC,MAAM,4DAAN,CAAd;AACAjB,uBAAOgB,KAAP;AACA,sBAAMA,KAAN;AACH,aAJK,MAID;AACDjB,wBAAQ,IAAR;AACH;AACJ,SArBY,CAAb;AAsBH;AACDe,eAAU;AACN,eAAO,KAAKI,QAAL,GAAgBJ,QAAhB,EAAP;AACH;AACDI,eAAU;AACN,eAAO,KAAKC,SAAL,CAAexB,WAAtB;AACH;AACDyB,cAAS;AACL,eAAO,KAAKnB,WAAZ;AACH;;AAEDoB,cAAS;AACL,eAAO,KAAKvB,KAAZ;AACH;AACD,WAAOgB,QAAP,GAAiB;AACb,eAAO,KAAKR,UAAZ;AACH;AAxCsB;kBAANZ,M","file":"module.js","sourcesContent":["import Channel from \"../communication/channel\";\r\nexport default class Module{\r\n    constructor(request, canBeDirectlyInstantiated){\r\n        this.ready = new Promise((resolve, reject)=>{\r\n            if(request){\r\n                const requestPath = new RequestPath(request.origin);\r\n                this.requestPath = requestPath.augmentPath(this.getClsas().modulePath, 0);\r\n                Registry._deregisterModuleInstance(this).then(ID=>{\r\n                    Channel.createSender(\r\n                        request.origin,\r\n                        request.type,\r\n                        this.requestPath.toString(true)\r\n                    ).then(channel=>{\r\n                        this.origin = channel;\r\n                        resolve(this);\r\n                    });\r\n                });\r\n            }else if(!canBeDirectlyInstantiated){\r\n                const error = Error(\"This module can only be instantiated from a handle request\");\r\n                reject(error);\r\n                throw error;\r\n            }else{\r\n                resolve(this);\r\n            }\r\n        });\r\n    }\r\n    toString(){\r\n        return this.getClass().toString();\r\n    }\r\n    getClass(){\r\n        return this.__proto__.constructor;\r\n    }\r\n    getPath(){\r\n        return this.requestPath;\r\n    }\r\n\r\n    __ready(){\r\n        return this.ready;\r\n    }\r\n    static toString(){\r\n        return this.modulePath;\r\n    }\r\n}\r\n"]}